<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Change Password - HealHub Doctor</title>
        <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
        <style>
            body { background-color: #f6f7fb; }
            .container-narrow { max-width: 600px; }
            .card { border-radius: 1rem; box-shadow: 0 2px 12px #0001; }
        </style>
    </head>
    <body>
        <nav class="navbar navbar-light bg-white border-bottom sticky-top shadow-sm">
            <div class="container-fluid">
                <a class="navbar-brand fw-bold text-primary" href="doctor-dashboard.html"><i class="fa-solid fa-heart-pulse me-2"></i>HealHub Doctor</a>
                <div class="d-flex align-items-center gap-2">
                    <a class="btn btn-outline-primary btn-sm" href="patient-records-list.html"><i class="fa-solid fa-users me-1"></i>Patients</a>
                    <a class="btn btn-outline-primary btn-sm" href="prescription-list.html"><i class="fa-solid fa-pills me-1"></i>Prescriptions</a>
                    <a class="btn btn-outline-primary btn-sm" href="lab-request-list.html"><i class="fa-solid fa-vials me-1"></i>Lab Requests</a>
                    <a class="btn btn-outline-secondary btn-sm" href="profile-view.html"><i class="fa-solid fa-user me-1"></i>Profile</a>
                    <a class="btn btn-outline-danger btn-sm" href="../auth/login.html"><i class="fa-solid fa-arrow-right-from-bracket me-1"></i>Logout</a>
                </div>
            </div>
        </nav>
        <main class="container container-narrow py-4">
            <div class="card p-4 mb-4">
                <h1 class="h4 mb-3"><i class="fa-solid fa-key me-2 text-primary"></i>Change Password</h1>
                
                <div class="alert alert-info mb-4">
                    <i class="fa-solid fa-info-circle me-2"></i>
                    <strong>Password Requirements:</strong> Your password must be at least 8 characters long and contain a mix of letters, numbers, and special characters.
                </div>

                <form>
                    <div class="mb-4">
                        <label class="form-label">Current Password *</label>
                        <div class="input-group">
                            <input type="password" class="form-control" id="currentPassword" required>
                            <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('currentPassword')">
                                <i class="fa-solid fa-eye" id="currentPasswordIcon"></i>
                            </button>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="form-label">New Password *</label>
                        <div class="input-group">
                            <input type="password" class="form-control" id="newPassword" required>
                            <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('newPassword')">
                                <i class="fa-solid fa-eye" id="newPasswordIcon"></i>
                            </button>
                        </div>
                        <div class="form-text">
                            <div id="passwordStrength" class="mt-2">
                                <div class="progress" style="height: 5px;">
                                    <div class="progress-bar" id="strengthBar" role="progressbar" style="width: 0%"></div>
                                </div>
                                <small id="strengthText" class="text-muted">Enter a password to see strength</small>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="form-label">Confirm New Password *</label>
                        <div class="input-group">
                            <input type="password" class="form-control" id="confirmPassword" required>
                            <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('confirmPassword')">
                                <i class="fa-solid fa-eye" id="confirmPasswordIcon"></i>
                            </button>
                        </div>
                        <div id="passwordMatch" class="form-text"></div>
                    </div>

                    <div class="mb-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="logoutOtherDevices">
                            <label class="form-check-label" for="logoutOtherDevices">
                                Log out from all other devices after password change
                            </label>
                        </div>
                    </div>

                    <div class="d-flex justify-content-between">
                        <a href="profile-view.html" class="btn btn-outline-secondary">Cancel</a>
                        <button type="submit" class="btn btn-primary">Change Password</button>
                    </div>
                </form>
            </div>
        </main>
        <script src="../assets/js/bootstrap.bundle.min.js"></script>
        <script>
            function togglePassword(inputId) {
                const input = document.getElementById(inputId);
                const icon = document.getElementById(inputId + 'Icon');
                
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            }

            function checkPasswordStrength(password) {
                let strength = 0;
                let strengthText = '';
                let strengthColor = '';

                if (password.length >= 8) strength++;
                if (/[a-z]/.test(password)) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;

                switch (strength) {
                    case 0:
                    case 1:
                        strengthText = 'Very Weak';
                        strengthColor = 'bg-danger';
                        break;
                    case 2:
                        strengthText = 'Weak';
                        strengthColor = 'bg-warning';
                        break;
                    case 3:
                        strengthText = 'Fair';
                        strengthColor = 'bg-info';
                        break;
                    case 4:
                        strengthText = 'Good';
                        strengthColor = 'bg-primary';
                        break;
                    case 5:
                        strengthText = 'Strong';
                        strengthColor = 'bg-success';
                        break;
                }

                const strengthBar = document.getElementById('strengthBar');
                const strengthTextEl = document.getElementById('strengthText');
                
                strengthBar.style.width = (strength * 20) + '%';
                strengthBar.className = 'progress-bar ' + strengthColor;
                strengthTextEl.textContent = strengthText;
            }

            function checkPasswordMatch() {
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const matchDiv = document.getElementById('passwordMatch');

                if (confirmPassword === '') {
                    matchDiv.innerHTML = '';
                    return;
                }

                if (newPassword === confirmPassword) {
                    matchDiv.innerHTML = '<small class="text-success"><i class="fa-solid fa-check me-1"></i>Passwords match</small>';
                } else {
                    matchDiv.innerHTML = '<small class="text-danger"><i class="fa-solid fa-times me-1"></i>Passwords do not match</small>';
                }
            }

            document.getElementById('newPassword').addEventListener('input', function() {
                checkPasswordStrength(this.value);
                checkPasswordMatch();
            });

            document.getElementById('confirmPassword').addEventListener('input', checkPasswordMatch);
        </script>
    </body>
</html>
